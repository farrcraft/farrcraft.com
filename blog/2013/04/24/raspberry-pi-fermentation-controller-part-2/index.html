<!doctype html><html><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="ie=edge"><link rel=icon href=/favicon.png type=image/gif><link rel=preconnect href=https://fonts.googleapis.com><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link href="https://fonts.googleapis.com/css2?family=Alata&family=Lora:ital,wght@0,400;0,500;0,600;0,700;1,400;1,500;1,600;1,700&family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&display=swap" rel=stylesheet><link rel=stylesheet href=/css/font.css media=all><meta property="og:title" content="Raspberry Pi Fermentation Controller – Part 2"><meta property="og:description" content="In part 1 I walked through getting the Raspberry Pi initially up and running. Once you’re logged in, you can immediately start hooking up sensors and start polling them directly from the command line. However, you’re likely going to want some more software installed for additional tasks. For my fermentation controller, I’ve decided on the following software stack.
Software Stack Graphite StatsD Node.js MongoDB All of the data read from sensors along with GPIO state changes will all be recorded in Graphite."><meta property="og:type" content="article"><meta property="og:url" content="https://farrcraft.com/blog/2013/04/24/raspberry-pi-fermentation-controller-part-2/"><meta property="article:section" content="blog"><meta property="article:published_time" content="2013-04-24T00:00:00+00:00"><meta property="article:modified_time" content="2013-04-24T00:00:00+00:00"><meta property="og:site_name" content="farrcraft.com"><meta name=twitter:card content="summary"><meta name=twitter:title content="Raspberry Pi Fermentation Controller – Part 2"><meta name=twitter:description content="In part 1 I walked through getting the Raspberry Pi initially up and running. Once you’re logged in, you can immediately start hooking up sensors and start polling them directly from the command line. However, you’re likely going to want some more software installed for additional tasks. For my fermentation controller, I’ve decided on the following software stack.
Software Stack Graphite StatsD Node.js MongoDB All of the data read from sensors along with GPIO state changes will all be recorded in Graphite."><link rel=stylesheet href=/bootstrap-5/css/bootstrap.min.css media=all><link rel=stylesheet href=/css/header.css media=all><link rel=stylesheet href=/css/footer.css media=all><link rel=stylesheet href=/css/theme.css media=all><style>:root{--text-color:#343a40;--text-secondary-color:#6c757d;--background-color:#eaedf0;--secondary-background-color:#64ffda1a;--primary-color:#007bff;--secondary-color:#f8f9fa;--text-color-dark:#e4e6eb;--text-secondary-color-dark:#b0b3b8;--background-color-dark:#18191a;--secondary-background-color-dark:#212529;--primary-color-dark:#ffffff;--secondary-color-dark:#212529}body{font-size:1rem;font-weight:400;line-height:1.5;text-align:left}</style><meta name=description content><link rel=stylesheet href=/css/single.css><script defer src=/fontawesome-5/all-5.15.4.js></script><title>Raspberry Pi Fermentation Controller – Part 2 | farrcraft.com</title></head><body class=light onload=loading()><script src=/bootstrap-5/js/bootstrap.bundle.js></script>
<script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header><nav class="pt-3 navbar navbar-expand-lg"><div class="container-fluid mx-xs-2 mx-sm-5 mx-md-5 mx-lg-5"><a class="navbar-brand primary-font text-wrap" href=/><img src=/favicon.png width=30 height=30 class="d-inline-block align-top">
farrcraft.com</a>
<button class=navbar-toggler type=button data-bs-toggle=collapse data-bs-target=#navbarContent aria-controls=navbarContent aria-expanded=false aria-label="Toggle navigation"><svg aria-hidden="true" height="24" viewBox="0 0 16 16" width="24" data-view-component="true"><path fill-rule="evenodd" d="M1 2.75A.75.75.0 011.75 2h12.5a.75.75.0 110 1.5H1.75A.75.75.0 011 2.75zm0 5A.75.75.0 011.75 7h12.5a.75.75.0 110 1.5H1.75A.75.75.0 011 7.75zM1.75 12a.75.75.0 100 1.5h12.5a.75.75.0 100-1.5H1.75z"/></svg></button><div class="collapse navbar-collapse text-wrap primary-font" id=navbarContent><ul class="navbar-nav ms-auto text-center"><li class="nav-item navbar-text"><a class=nav-link href=/#about aria-label=about>About</a></li><li class="nav-item navbar-text"><a class=nav-link href=/#experience aria-label=experience>Experience</a></li><li class="nav-item navbar-text"><a class=nav-link href=/#projects aria-label=projects>Projects</a></li><li class="nav-item navbar-text"><a class=nav-link href=/blog title="Blog posts">Blog</a></li><li class="nav-item navbar-text dropdown"><a class="nav-link dropdown-toggle" href id=navbarDropdown role=button data-bs-toggle=dropdown aria-haspopup=true aria-expanded=false title=Homebrew>Homebrew</a><div class="dropdown-menu shadow-lg rounded" aria-labelledby=navbarDropdown><a class="dropdown-item text-left nav-link" href=/homebrew title=Posts>Posts</a>
<a class="dropdown-item text-left nav-link" href=/brew-log title="Brew Log">Brew Log</a>
<a class="dropdown-item text-left nav-link" href=/bottle-labels title="Bottle Labels">Bottle Labels</a></div></li><li class="nav-item navbar-text"><a class=nav-link href=/food title=Food>Food</a></li><li class="nav-item navbar-text"><a class=nav-link href=/photography title=Photography>Photography</a></li><li class="nav-item navbar-text"><a class=nav-link href=/workshop title=Workshop>Workshop</a></li></ul><div class=text-center><button id=theme-toggle><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div></div></nav></header><div id=content><section id=single><div class=container><div class="row justify-content-center"><div class="col-sm-12 col-md-12 col-lg-9"><div class=pr-lg-4><div class="title mb-5"><h1 class="text-center mb-4">Raspberry Pi Fermentation Controller – Part 2</h1><div class=text-center>Josh
<small>|</small>
Apr 24, 2013</div></div><div class=featured-image><img class=img-fluid src=/uploads/2013/04/pi_console.jpg alt="Raspberry Pi Fermentation Controller – Part 2"></div><article class="page-content p-2"><p>In <a href=http://www.quantumfish.com/blog/2013/04/20/raspberry-pi-pt-1/>part 1</a> I walked through getting the Raspberry Pi initially up and running. Once you’re logged in, you can immediately start hooking up sensors and start polling them directly from the command line. However, you’re likely going to want some more software installed for additional tasks. For my fermentation controller, I’ve decided on the following software stack.</p><h2 id=software-stack>Software Stack</h2><ul><li><a href=http://graphite.readthedocs.org/en/0.9.10/>Graphite</a></li><li><a href=http://codeascraft.etsy.com/2011/02/15/measure-anything-measure-everything/>StatsD</a></li><li><a href=http://nodejs.org/>Node.js</a></li><li><a href=http://www.mongodb.org/>MongoDB</a></li></ul><p>All of the data read from sensors along with GPIO state changes will all be recorded in Graphite. Graphite stores the data and provides tools for generating graphs from it. The StatsD server will be responsible for sending data to the graphite server. I’ll be using Node.js for communicating with the sensors and providing a web-based interface to interact with the entire system. The web UI will also use MongoDB for storing additional fermentation data.</p><p><img src=http://www.quantumfish.com/images/pi/pi_console.jpg alt></p><h2 id=screen>Screen</h2><p>Before starting to install all of the necessary software, it’s a good idea to install the screen program and start it up. Some of the steps can take a long time to complete and if your SSH session gets disconnected, screen will keep the session active. In that case all you need to do is reconnect and run the screen command to reattach to your previous running session.Using screen</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sudo apt-get install screen
</span></span><span style=display:flex><span><span style=color:#75715e># start screen</span>
</span></span><span style=display:flex><span>screen
</span></span><span style=display:flex><span><span style=color:#75715e># list active sessions after reconnecting</span>
</span></span><span style=display:flex><span>screen -ls
</span></span><span style=display:flex><span><span style=color:#75715e># reattach the screen listed in the output from the last command, e.g.:</span>
</span></span><span style=display:flex><span>screen -r 11592.pts-0.raspberrypi
</span></span></code></pre></div><h2 id=nodejs>Node.js</h2><p>There are to ways to install Node.js. You can choose to either install a package via apt-get or to compile it directly from source. While the first option is quick and simple, you’ll get a much older version (currently 0.6.19) than if you build it yourself.Installing Node.js from a package</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># this will install version 0.6.19 of node</span>
</span></span><span style=display:flex><span>sudo apt-get install nodejs
</span></span><span style=display:flex><span><span style=color:#75715e># if you decide you don&#39;t want this version then you can uninstall it</span>
</span></span><span style=display:flex><span>sudo apt-get purge nodejs
</span></span></code></pre></div><p>Fortunately, the most recent versions of Node.js have support for the Pi’s architecture. So Building from source is a fairly straightforward series of steps and doesn’t require any complex patching steps as it did for older versions. The downside is that it’ll take at least several hours to compile. The following steps should result in a fresh installation of the most recent release version of Node.js.Compiling Node.js</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># install dependencies needed for compiling software</span>
</span></span><span style=display:flex><span>sudo apt-get install git-core build-essential
</span></span><span style=display:flex><span><span style=color:#75715e># download the Node.js source repository</span>
</span></span><span style=display:flex><span>git clone https://github.com/joyent/node.git
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>cd node
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># list remote branches</span>
</span></span><span style=display:flex><span>git branch -r
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># change the repository to the source tagged as version 0.10.4</span>
</span></span><span style=display:flex><span>git checkout -t origin/v0.10.4-release
</span></span><span style=display:flex><span><span style=color:#75715e># configure &amp; compile</span>
</span></span><span style=display:flex><span>./configure
</span></span><span style=display:flex><span>make
</span></span><span style=display:flex><span><span style=color:#75715e># install</span>
</span></span><span style=display:flex><span>make install
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># verify the node application is installed in /usr/local/bin/node</span>
</span></span><span style=display:flex><span>which node
</span></span><span style=display:flex><span><span style=color:#75715e># check that the version matches what you just installed</span>
</span></span><span style=display:flex><span>node -v
</span></span></code></pre></div><h2 id=graphite>Graphite</h2><p>Getting Graphite installed isn’t much more work. Since it is a python application it also takes quite a bit less time than compiling Node.js. However, there is some additional configuration work that has to be done. Graphite is composed of several different components. The backend component is called Carbon. The Carbon server is what StatsD will send its data to. The web accessible interface portion responsible for generating the graphs is known as Graphite. Since this is a web interface, we also need a web server. So, the Apache web server will also be installed during the process. If you’d rather have a more automated procedure itt’s also possible to script most of these steps as in this <a href=https://github.com/ghoulmann/rpi-graphite/blob/master/rpi-graphite.sh>example</a>.Installing Graphite</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># switch to root user</span>
</span></span><span style=display:flex><span>sudo -i
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># install python dependencies</span>
</span></span><span style=display:flex><span>apt-get install python-pip python-cairo python-django python-django-tagging python-twisted
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># install apache</span>
</span></span><span style=display:flex><span>apt-get install apache2 libapache2-mod-wsgi libapache2-mod-python
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># install graphite</span>
</span></span><span style=display:flex><span>pip install whisper
</span></span><span style=display:flex><span>pip install carbon
</span></span><span style=display:flex><span>pip install graphite-web
</span></span></code></pre></div><p>Graphite comes with a good collection of example configuration files that provide a good set of defaults to get started with. Only a few edits in a few spots are necessary to get going. It’s a good idea to take a look through each configuration file anyway to get an idea of the options that are available.Configuring Graphite</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># switch to graphite config directory and copy the example configs</span>
</span></span><span style=display:flex><span>cd /opt/graphite/conf
</span></span><span style=display:flex><span>cp carbon.conf.example carbon.conf
</span></span><span style=display:flex><span>cp aggregation-rules.conf.example aggregation-rules.conf
</span></span><span style=display:flex><span>cp storage-aggregation.conf.example storage-aggregation.conf
</span></span><span style=display:flex><span>cp relay-rules.conf.example relay-rules.conf
</span></span><span style=display:flex><span>cp storage-schemas.conf.example storage-schemas.conf
</span></span><span style=display:flex><span>cp dashboard.conf.example dashboard.conf
</span></span><span style=display:flex><span>cp graphTemplates.conf.example graphTemplates.conf
</span></span><span style=display:flex><span>cp graphite.wsgi.example graphite.wsgi
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>cd /opt/graphite/webapp/graphite
</span></span><span style=display:flex><span>cp local_settings.py.example local_settings.py
</span></span><span style=display:flex><span><span style=color:#75715e># uncomment timezone setting (default is CST, but we&#39;re in PST)</span>
</span></span><span style=display:flex><span>sed -i <span style=color:#e6db74>&#39;s/\#TIME_ZONE/TIME_ZONE/g&#39;</span> local_settings.py
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>nano -w local_settings.py
</span></span><span style=display:flex><span><span style=color:#75715e># find and uncomment DATABASES = … block</span>
</span></span><span style=display:flex><span>python manage.py syncdb
</span></span><span style=display:flex><span><span style=color:#75715e># answer prompts - yes, blank for default username (root), enter email address, enter password (e.g. raspberry)</span>
</span></span><span style=display:flex><span>chown -R www-data:www-data /opt/graphite/storage/
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># configure Apache</span>
</span></span><span style=display:flex><span>wget https://raw.github.com/tmm1/graphite/master/examples/example-graphite-vhost.conf -O /etc/apache2/sites-available/graphite
</span></span><span style=display:flex><span><span style=color:#75715e># change default socket path from /etc/httpd/wsgi which doesn&#39;t exist to /var/run/apache2</span>
</span></span><span style=display:flex><span>sed -i <span style=color:#e6db74>&#39;s/\/etc\/httpd\/wsgi\//\/var\/run\/apache2\//g&#39;</span> /etc/apache2/sites-available/graphite
</span></span><span style=display:flex><span><span style=color:#75715e># set django root path</span>
</span></span><span style=display:flex><span>sed -i<span style=color:#e6db74>&#39;s/@DJANGO_ROOT@/\/usr\/lib\/python2.7\/dist-packages\/django/g&#39;</span> /etc/apache2/sites-available/graphite
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># enable graphite website</span>
</span></span><span style=display:flex><span>a2ensite graphite
</span></span><span style=display:flex><span><span style=color:#75715e># restart apache to apply changes</span>
</span></span><span style=display:flex><span>service apache2 reload
</span></span></code></pre></div><p>At this point you could manually start up the carbon server and connect to the graphite web site. Instead, we’re going to install one more script that will make sure that carbon is started automatically whenever the Pi is booted.Carbon init script</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>wget https://raw.github.com/sigsegv42/rpi-ferment/master/scripts/carbon -O /etc/init.d/carbon
</span></span><span style=display:flex><span>chmod <span style=color:#ae81ff>755</span> /etc/init.d/carbon
</span></span><span style=display:flex><span><span style=color:#75715e># set default runlevels for carbon service</span>
</span></span><span style=display:flex><span>update-rc.d carbon defaults
</span></span><span style=display:flex><span><span style=color:#75715e># start up carbon</span>
</span></span><span style=display:flex><span>/etc/init.d/carbon start
</span></span></code></pre></div><p>If everything was successful, you should now be able to access graphite in your web browser. The default Apache configuration assigns the name ‘graphite’ to the website. To be able to access it, you’ll need to map that name to the IP of the Raspberry Pi in your hosts file. On OSX or GNU/Linux platforms you would edit the file <em>/etc/hosts</em>. The file in MS Windows is usually located at <em>C:\Windows\System32\drivers\etc\hosts</em>. The new entry would look similiar to this:</p><blockquote><p>192.168.2.189 graphite</p></blockquote><p>modified to reflect the actual IP of the Pi. After the hosts file has been updated, you should be able to open <a href=http://graphite/>http://graphite/</a> in the web browser of your choice. If it worked, you should see the Grahpite graph composer interface. Of course, it’ll be a bit boring still until you start logging some data.</p><h2 id=statsd>StatsD</h2><p>StatsD is a small Node.js application and doesn’t require any special installation steps on its own. You could just download the source repository and start running it. However, we’d like to have it automatically start up when the system boots up just like we setup carbon. Fortunately, the StatsD repository includes everything needed to turn the source into a debian package complete with boot scripts.Building the statsd debian package</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># install devscripts (pulls in lots of little perl modules) needed to build debian packages</span>
</span></span><span style=display:flex><span>apt-get install devscripts
</span></span><span style=display:flex><span><span style=color:#75715e># download statsd source</span>
</span></span><span style=display:flex><span>git clone git://github.com/etsy/statsd.git
</span></span><span style=display:flex><span>cd statsd
</span></span><span style=display:flex><span><span style=color:#75715e># remove the nodejs package dependency since we installed node from source</span>
</span></span><span style=display:flex><span>sed -i <span style=color:#e6db74>&#39;s/\, .*//g&#39;</span> debian/control
</span></span><span style=display:flex><span><span style=color:#75715e># build a debian package for statsd</span>
</span></span><span style=display:flex><span>debuild -us -uc
</span></span><span style=display:flex><span><span style=color:#75715e># install the statsd package</span>
</span></span><span style=display:flex><span>dpkg -i ../statsd_0.0.3_all.deb
</span></span><span style=display:flex><span><span style=color:#75715e># add statsd to boot</span>
</span></span><span style=display:flex><span>update-rc.d statsd defaults
</span></span><span style=display:flex><span><span style=color:#75715e># copy statsd config</span>
</span></span><span style=display:flex><span>wget https://raw.github.com/sigsegv42/rpi-ferment/master/lib/statsdConfig.js -O /etc/statsd/localConfig.js
</span></span><span style=display:flex><span><span style=color:#75715e># start statsd</span>
</span></span><span style=display:flex><span>/etc/init.d/statsd start
</span></span></code></pre></div><h2 id=mongodb>MongoDB</h2><p>The last piece of software in our stack is MongoDB. Unfortunately, the stock version doesn’t support the Pi’s architecture. Luckily there are several forks which have added this support. I’ve chosen to use one called <em>mongopi</em>. This is a slightly older version based on 2.1.1, but it should work for our needs on the Pi. This approach also means that we’re compiling from source again. You’ll want to make sure that you’re running screen before you start because MongoDB takes a really long time to build and install – on the order of 12 hours long. Once you hit enter on the scons command, you may just want to leave it to run and check back in on it tomorrow.Installing mongodb</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># install mongodb build dependencies</span>
</span></span><span style=display:flex><span>apt-get install scons libpcre++-dev xulrunner-dev libboost-dev libboost-program-options-dev libboost-thread-dev libboost-filesystem-dev
</span></span><span style=display:flex><span><span style=color:#75715e># checkout a fork of mongodb customized to support the Pi</span>
</span></span><span style=display:flex><span>git clone git://github.com/RickP/mongopi.git
</span></span><span style=display:flex><span>cd mongopi/
</span></span><span style=display:flex><span><span style=color:#75715e># build</span>
</span></span><span style=display:flex><span>scons
</span></span><span style=display:flex><span><span style=color:#75715e># install</span>
</span></span></code></pre></div><p>As we did with the other components, we want to make sure that MongoDB starts up during boot. There are also a few directories to be created before mongo can be started.Configuring mongodb</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># create a user that the server will run under</span>
</span></span><span style=display:flex><span>useradd mongodb
</span></span><span style=display:flex><span><span style=color:#75715e># create db storage, log, and configuration directories</span>
</span></span><span style=display:flex><span>mkdir /var/lib/mongodb
</span></span><span style=display:flex><span>mkdir /var/log/mongodb
</span></span><span style=display:flex><span>mkdir /etc/mongodb
</span></span><span style=display:flex><span><span style=color:#75715e># configuration file with any additional startup options. empty is fine but it has to exist</span>
</span></span><span style=display:flex><span>touch /etc/mongodb/mongodb.conf
</span></span><span style=display:flex><span><span style=color:#75715e># set ownership</span>
</span></span><span style=display:flex><span>chown mongodb:mongodb /var/lib/mongodb
</span></span><span style=display:flex><span>chown mongodb:mongodb /var/log/mongodb/
</span></span><span style=display:flex><span><span style=color:#75715e># add the mongo path to the global system path</span>
</span></span><span style=display:flex><span>echo <span style=color:#e6db74>&#34;PATH=</span>$PATH<span style=color:#e6db74>:/opt/mongo/bin/&#34;</span> &amp;gt;&amp;gt; /etc/environment
</span></span><span style=display:flex><span>echo <span style=color:#e6db74>&#34;export PATH&#34;</span> &amp;gt;&amp;gt; /etc/environment
</span></span><span style=display:flex><span><span style=color:#75715e># setup the init script</span>
</span></span><span style=display:flex><span>wget https://gist.github.com/ni-c/fd4df404bda6e87fb718/raw/36d45897cd943fbd6d071c096eb4b71b37d0fcbb/mongodb.sh -O /etc/init.d/mongodb
</span></span><span style=display:flex><span>chmod <span style=color:#ae81ff>755</span> /etc/init.d/mongodb
</span></span><span style=display:flex><span>update-rc.d mongodb defaults
</span></span><span style=display:flex><span><span style=color:#75715e># start the mongodb service</span>
</span></span><span style=display:flex><span>service mongodb start
</span></span></code></pre></div><h2 id=conclusion>Conclusion</h2><p>After going through all of these steps, you’ll have a Raspberry Pi running with Graphite, StatsD, MongoDB, and Node.js. It’s a good idea to try rebooting (<em>shutdown -r now</em> will accomplish this) and make sure that all of the services start up on boot as they’re supposed to. The <em>ps</em> command can be used to show running processes and verify that the services are all running. In <a href=http://www.quantumfish.com/blog/2013/05/14/raspberry-pi-pt-3/>part 3</a> I’ll cover the rest of the hardware components of the project and how to get all of the sensors wired up.</p></article></div></div><div class="col-sm-12 col-md-12 col-lg-3"><div class=sticky-sidebar><aside class=toc><h5>Table Of Contents</h5><div class=toc-content><nav id=TableOfContents><ul><li><a href=#software-stack>Software Stack</a></li><li><a href=#screen>Screen</a></li><li><a href=#nodejs>Node.js</a></li><li><a href=#graphite>Graphite</a></li><li><a href=#statsd>StatsD</a></li><li><a href=#mongodb>MongoDB</a></li><li><a href=#conclusion>Conclusion</a></li></ul></nav></div></aside></div></div></div><div class=row><div class="col-sm-12 col-md-12 col-lg-9 p-4"></div></div></div><button class="p-2 px-3" onclick=topFunction() id=topScroll>
<i class="fas fa-angle-up"></i></button></section><script>var topScroll=document.getElementById("topScroll");window.onscroll=function(){scrollFunction()};function scrollFunction(){document.body.scrollTop>20||document.documentElement.scrollTop>20?topScroll.style.display="block":topScroll.style.display="none"}function topFunction(){document.body.scrollTop=0,document.documentElement.scrollTop=0}</script></div><footer><div class="container py-3" id=recent-posts></div><div class="text-center pt-2"><span class=px-1><a href=https://github.com/farrcraft aria-label=github><svg xmlns="http://www.w3.org/2000/svg" width="2.7em" height="2.7em" viewBox="0 0 1792 1792"><path d="M522 1352q-8 9-20-3-13-11-4-19 8-9 20 3 12 11 4 19zm-42-61q9 12 0 19-8 6-17-7t0-18q9-7 17 6zm-61-60q-5 7-13 2-10-5-7-12 3-5 13-2 10 5 7 12zm31 34q-6 7-16-3-9-11-2-16 6-6 16 3 9 11 2 16zm129 112q-4 12-19 6-17-4-13-15t19-7q16 5 13 16zm63 5q0 11-16 11-17 2-17-11 0-11 16-11 17-2 17 11zm58-10q2 10-14 14t-18-8 14-15q16-2 18 9zm964-956v960q0 119-84.5 203.5T1376 1664h-224q-16 0-24.5-1t-19.5-5-16-14.5-5-27.5v-239q0-97-52-142 57-6 102.5-18t94-39 81-66.5 53-105T1386 856q0-121-79-206 37-91-8-204-28-9-81 11t-92 44l-38 24q-93-26-192-26t-192 26q-16-11-42.5-27T578 459.5 492 446q-44 113-7 204-79 85-79 206 0 85 20.5 150t52.5 105 80.5 67 94 39 102.5 18q-40 36-49 103-21 10-45 15t-57 5-65.5-21.5T484 1274q-19-32-48.5-52t-49.5-24l-20-3q-21 0-29 4.5t-5 11.5 9 14 13 12l7 5q22 10 43.5 38t31.5 51l10 23q13 38 44 61.5t67 30 69.5 7 55.5-3.5l23-4q0 38 .5 103t.5 68q0 22-11 33.5t-22 13-33 1.5H416q-119 0-203.5-84.5T128 1376V416q0-119 84.5-203.5T416 128h960q119 0 203.5 84.5T1664 416z"/></svg></a></span><span class=px-1><a href=https://www.linkedin.com/in/josh-farr/ aria-label=linkedin><svg xmlns="http://www.w3.org/2000/svg" width="2.4em" height="2.4em" fill="#fff" aria-label="LinkedIn" viewBox="0 0 512 512"><rect width="512" height="512" fill="#0077b5" rx="15%"/><circle cx="142" cy="138" r="37"/><path stroke="#fff" stroke-width="66" d="M244 194v198M142 194v198"/><path d="M276 282c0-20 13-40 36-40 24 0 33 18 33 45v105h66V279c0-61-32-89-76-89-34 0-51 19-59 32"/></svg></a></span></div><div class="container py-4"><div class="row justify-content-center"><div class="col-md-4 text-center"><div class=pb-2><a href=https://farrcraft.com/ title=farrcraft.com><img alt="Footer logo" src=/favicon.png height=40px width=40px></a></div>&copy; 2022 All Rights Reserved</div></div></div></footer><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))});var tooltipTriggerList=[].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]')),tooltipList=tooltipTriggerList.map(function(e){return new bootstrap.Tooltip(e)})</script><script>let loadingIcons;function loading(){myVar=setTimeout(showPage,100)}function showPage(){try{document.getElementById("loading-icons").style.display="block"}catch{}}</script></body></html>